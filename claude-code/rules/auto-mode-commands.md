# Claude Code 自動実行許可コマンド（Auto-mode）

Claude Code の「Auto-mode」を最大限に活用し、承認待ちによる中断を減らすための推奨設定です。セキュリティを担保しつつ、開発効率を上げるために以下を遵守すること。

## 1. 読み取り・探索系（推奨度：最高）

ファイルの変更を伴わないため、**常に許可（Allow all）**に設定してもリスクが非常に低い。AI の状況把握スピードが向上する。

| コマンド | 用途 |
| :---- | :---- |
| ls, find, fd | ディレクトリ構造の確認 |
| cat, bat, read | ファイル内容の閲覧 |
| grep, rg (ripgrep) | コード内の文字列検索 |
| git diff | 変更内容の差分確認 |
| git status, git log | リポジトリの状態や履歴の確認 |
| pwd | 現在の作業ディレクトリの確認 |

**ルール**: 上記のコマンドは許可リストに含めることを推奨する。実行時はユーザー承認を待たずに進めてよいとみなせる設定を推奨する。

## 2. 検証・品質管理系（推奨度：高）

「修正 → テスト → 再修正」のループを自律的に回せるようにする。

| カテゴリ | コマンド例 |
| :---- | :---- |
| **テスト実行** | npm test, pytest, go test, vitest, bundle exec rspec |
| **型チェック** | tsc (TypeScript), mypy (Python) |
| **リンター** | eslint, flake8, rubocop |
| **フォーマッタ** | prettier --check, black --check |

**ルール**: 上記は品質確認のため頻繁に実行する。許可リストに含めることを推奨する。

## 3. 環境・依存関係の確認（推奨度：中）

環境差異によるエラーを防ぐために頻繁に使用する。

- node -v, npm -v, python --version
- npm list --depth=0, pip list, go list
- env（機密情報が含まれる場合は注意が必要）
- docker ps, docker images

**ルール**: プロジェクトで使用するランタイム・パッケージマネージャに応じて許可を検討する。`env` は機密を含む可能性があるため、共有サーバーでは許可しない。

## 4. プロジェクト固有のビルド系

プロジェクトの構成に応じて追加を検討する。

- npm run build
- make
- go build

**ルール**: リポジトリに `package.json` / `Makefile` / `go.mod` 等がある場合、対応するビルドコマンドを許可リストに加えることを検討する。

---

## 許可すべきではない（手動確認を必須とする）コマンド

予期せぬ破壊的変更や情報漏洩を防ぐため、**毎回手動で承認する**こと。これらは許可リストに含めない。

### 破壊的な操作

- rm -rf（ディレクトリ削除）
- git reset --hard（変更の破棄）
- git push --force（履歴の強制上書き）

### デプロイ・インフラ操作

- terraform apply, aws s3 sync
- vercel --prod, firebase deploy

### 外部通信

- curl, wget（意図しないスクリプトの実行防止）

**ルール**: 上記を実行する必要がある場合は、必ずユーザーに説明し、明示的な承認を得てから実行する。Auto-mode の許可リストには追加しない。

---

## 設定のヒント

1. **スモールスタート**: まずは ls と grep だけを許可する。
2. **頻度の観察**: AI が何度も承認を求めてくる「安全なコマンド」をその都度許可リストに加える。
3. **セッション管理**: 作業が終わったら、必要に応じて許可設定をリセットまたは見直す。

**注意**: 共有サーバーや機密性の高い環境では、Allow all の範囲を最小限に留めること。
